import duckdb

import time

s = time.time()

con = duckdb.connect()

con.execute("copy (SELECT Ledger, Account, DC, Currency, SUM(Base_Amount) as Total_Base_Amount FROM read_csv_auto('input/300-MillionRows.csv') GROUP BY Ledger, Account, DC, Currency) to 'output/DuckGroupBy.csv' (format csv, header true);")

e = time.time()

print("DuckDB GroupBy Time = {}".format(round(e-s,3)))